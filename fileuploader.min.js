/* fileuploader.js v0.1.4dev by Dorian Nowak */
!function(e,t){var n=0,o=null,s=null,r=new XMLHttpRequest,i=new FormData,a=function(){if(r=new XMLHttpRequest,r.open("post",s.url,!0),null!=o&&(i.append("file",o.files[n]),r.timeout=s.timeout,s.onprogress&&"function"==typeof s.onprogress&&r.upload.addEventListener("progress",s.onprogress,!1),s.oncomplete&&"function"==typeof s.oncomplete&&r.addEventListener("loadend",function(){var e=this.getResponseHeader("content-type"),t=this.response;if("application/json"==e)try{t=JSON.parse(t)}catch(n){}s.oncomplete(t,this.status,this)},!1),s.onerror&&"function"==typeof s.onerror&&r.addEventListener("error",function(){var e=this.getResponseHeader("content-type"),t=this.response;if("application/json"==e)try{t=JSON.parse(t)}catch(n){}s.onerror(t,this.status,this)},!1),s.ontimeout&&"function"==typeof s.ontimeout&&r.addEventListener("timeout",function(){s.ontimeout(this,this.status)},!1)),s.headers)for(key in s.headers)r.setRequestHeader(key,s.headers[key]);if(s.data)for(key in s.data)i.append(key,s.data[key]);r.addEventListener("loadend",function(){p()},!1)};e.fileuploader=function(e){return"object"!=typeof e?null:(i=new FormData,s=e,o=document.querySelector(e.selector),a(),r.send(i),void 0)};var p=function(){o.files.length>1&&(n+=1,o.files[n]!=t?(delete r,r=new XMLHttpRequest,i=new FormData,i.append("file",o.files[n]),a(),r.send(i),delete i):(n=0,o.value=""))}}(window);