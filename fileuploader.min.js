(function(g,h){var d=0,e=null,a=null,b=new XMLHttpRequest,c=new FormData,f=function(){b=new XMLHttpRequest;b.open("post",a.url,!0);null!=e&&(c.append("file",e.files[d]),b.timeout=a.timeout,a.onprogress&&"function"==typeof a.onprogress&&b.upload.addEventListener("progress",a.onprogress,!1),a.oncomplete&&"function"==typeof a.oncomplete&&b.addEventListener("loadend",function(){var b=this.getResponseHeader("content-type"),c=this.response;if("application/json"==b)try{c=JSON.parse(c)}catch(e){}a.oncomplete(c,
this.status,this)},!1),a.onerror&&"function"==typeof a.onerror&&b.addEventListener("error",function(){a.onerror(this,this.status)},!1),a.ontimeout&&"function"==typeof a.ontimeout&&b.addEventListener("timeout",function(){a.ontimeout(this,this.status)},!1));if(a.headers)for(key in a.headers)b.setRequestHeader(key,a.headers[key]);if(a.data)for(key in a.data)c.append(key,a.data[key]);b.addEventListener("loadend",function(a){1<e.files.length&&(d+=1,e.files[d]!=h?(delete b,b=new XMLHttpRequest,c=new FormData,
c.append("file",e.files[d]),f(),b.send(c),delete c):(d=0,e.value=""))},!1)};g.fileuploader=function(d){if("object"==typeof d)c=new FormData,a=d,e=document.querySelector(d.selector),f(),b.send(c);else return null}})(window);